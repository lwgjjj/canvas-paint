var Base=new function(){var hidden=/^(statics|enumerable|beans|preserve)$/,array=[],slice=array.slice,create=Object.create,describe=Object.getOwnPropertyDescriptor,define=Object.defineProperty,forEach=array.forEach||function(iter,bind){for(var i=0,l=this.length;i<l;i++)iter.call(bind,this[i],i,this)},set=Object.assign||function(dst){for(var i=1,l=arguments.length;i<l;i++){var src=arguments[i];for(var key in src)src.hasOwnProperty(key)&&(dst[key]=src[key])}return dst},each=function(obj,iter,bind){if(obj){var desc=describe(obj,"length");(desc&&"number"==typeof desc.value?forEach:function(iter,bind){for(var i in this)this.hasOwnProperty(i)&&iter.call(bind,this[i],i,this)}).call(obj,iter,bind=bind||obj)}return bind};function inject(dest,src,enumerable,beans,preserve){var beansNames={};function field(name,val){"string"==typeof(val=val||(val=describe(src,name))&&(val.get?val:val.value))&&"#"===val[0]&&(val=dest[val.substring(1)]||val);var bean,isFunc="function"==typeof val,res=val,prev=preserve||isFunc&&!val.base?val&&val.get?name in dest:dest[name]:null;preserve&&prev||(isFunc&&prev&&(val.base=prev),isFunc&&!1!==beans&&(bean=name.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(beansNames[bean[3].toLowerCase()+bean[4]]=bean[2]),res&&!isFunc&&res.get&&"function"==typeof res.get&&Base.isPlainObject(res)||(res={value:res,writable:!0}),(describe(dest,name)||{configurable:!0}).configurable&&(res.configurable=!0,res.enumerable=null!=enumerable?enumerable:!bean),define(dest,name,res))}if(src){for(var name in src)src.hasOwnProperty(name)&&!hidden.test(name)&&field(name);for(var name in beansNames){var part=beansNames[name],set=dest["set"+part],get=dest["get"+part]||set&&dest["is"+part];!get||!0!==beans&&0!==get.length||field(name,{get:get,set:set})}}return dest}function Base(){for(var i=0,l=arguments.length;i<l;i++){var src=arguments[i];src&&set(this,src)}return this}return inject(Base,{inject:function(src){if(src){var statics=!0===src.statics?src:src.statics,beans=src.beans,preserve=src.preserve;statics!==src&&inject(this.prototype,src,src.enumerable,beans,preserve),inject(this,statics,null,beans,preserve)}for(var i=1,l=arguments.length;i<l;i++)this.inject(arguments[i]);return this},extend:function(){for(var ctor,proto,obj,base=this,i=0,l=arguments.length;i<l&&(!ctor||!proto);i++)obj=arguments[i],ctor=ctor||obj.initialize,proto=proto||obj.prototype;return proto=(ctor=ctor||function(){base.apply(this,arguments)}).prototype=proto||create(this.prototype),define(proto,"constructor",{value:ctor,writable:!0,configurable:!0}),inject(ctor,this),arguments.length&&this.inject.apply(ctor,arguments),ctor.base=base,ctor}}).inject({enumerable:!1,initialize:Base,set:Base,inject:function(){for(var i=0,l=arguments.length;i<l;i++){var src=arguments[i];src&&inject(this,src,src.enumerable,src.beans,src.preserve)}return this},extend:function(){var res=create(this);return res.inject.apply(res,arguments)},each:function(iter,bind){return each(this,iter,bind)},clone:function(){return new this.constructor(this)},statics:{set:set,each:each,create:create,define:define,describe:describe,clone:function(obj){return set(new obj.constructor,obj)},isPlainObject:function(obj){var ctor=null!=obj&&obj.constructor;return ctor&&(ctor===Object||ctor===Base||"Object"===ctor.name)},pick:function(a,b){return void 0!==a?a:b},slice:function(list,begin,end){return slice.call(list,begin,end)}}})};"undefined"!=typeof module&&(module.exports=Base),Base.inject({enumerable:!1,getClassName:function(){return this._class||""},importJSON:function(json){return Base.importJSON(json,this)},exportJSON:function(options){return Base.exportJSON(this,options)},toJSON:function(){return Base.serialize(this)},set:function(props,exclude){return props&&Base.filter(this,props,exclude,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function extend(){var res=extend.base.apply(this,arguments),name=res.prototype._class;return name&&!Base.exports[name]&&(Base.exports[name]=res),res},equals:function(obj1,obj2){if(obj1===obj2)return!0;if(obj1&&obj1.equals)return obj1.equals(obj2);if(obj2&&obj2.equals)return obj2.equals(obj1);if(obj1&&obj2&&"object"==typeof obj1&&"object"==typeof obj2){if(Array.isArray(obj1)&&Array.isArray(obj2)){if((length=obj1.length)!==obj2.length)return!1;for(;length--;)if(!Base.equals(obj1[length],obj2[length]))return!1}else{var length,keys=Object.keys(obj1);if((length=keys.length)!==Object.keys(obj2).length)return!1;for(;length--;){var key=keys[length];if(!obj2.hasOwnProperty(key)||!Base.equals(obj1[key],obj2[key]))return!1}}return!0}return!1},read:function(list,start,options,amount){if(this===Base){var value=this.peek(list,start);return list.__index++,value}var proto=this.prototype,readIndex=proto._readIndex,begin=start||readIndex&&list.__index||0,length=list.length,obj=list[begin];if(amount=amount||length-begin,obj instanceof this||options&&options.readNull&&null==obj&&amount<=1)return readIndex&&(list.__index=begin+1),obj&&options&&options.clone?obj.clone():obj;if(obj=Base.create(proto),readIndex&&(obj.__read=!0),obj=obj.initialize.apply(obj,0<begin||begin+amount<length?Base.slice(list,begin,begin+amount):list)||obj,readIndex){list.__index=begin+obj.__read;var filtered=obj.__filtered;filtered&&(list.__filtered=filtered,obj.__filtered=void 0),obj.__read=void 0}return obj},peek:function(list,start){return list[list.__index=start||list.__index||0]},remain:function(list){return list.length-(list.__index||0)},readList:function(list,start,options,amount){for(var entry,res=[],begin=start||0,end=amount?begin+amount:list.length,i=begin;i<end;i++)res.push(Array.isArray(entry=list[i])?this.read(entry,0,options):this.read(list,i,options,1));return res},readNamed:function(list,name,start,options,amount){var value=this.getNamed(list,name),hasObject=void 0!==value;if(hasObject){var filtered=list.__filtered;filtered||((filtered=list.__filtered=Base.create(list[0])).__unfiltered=list[0]),filtered[name]=void 0}var l=hasObject?[value]:list;return this.read(l,start,options,amount)},getNamed:function(list,name){var arg=list[0];if(void 0===list._hasObject&&(list._hasObject=1===list.length&&Base.isPlainObject(arg)),list._hasObject)return name?arg[name]:list.__filtered||arg},hasNamed:function(list,name){return!!this.getNamed(list,name)},filter:function(dest,source,exclude,prioritize){var processed;function handleKey(key){if(!(exclude&&key in exclude||processed&&key in processed)){var value=source[key];void 0!==value&&(dest[key]=value)}}if(prioritize){for(var key,keys={},i=0,l=prioritize.length;i<l;i++)(key=prioritize[i])in source&&(handleKey(key),keys[key]=!0);processed=keys}return Object.keys(source.__unfiltered||source).forEach(handleKey),dest},isPlainValue:function(obj,asString){return Base.isPlainObject(obj)||Array.isArray(obj)||asString&&"string"==typeof obj},serialize:function(obj,options,compact,dictionary){options=options||{};var res,isRoot=!dictionary;if(isRoot&&(options.formatter=new Formatter(options.precision),dictionary={length:0,definitions:{},references:{},add:function(item,create){var id="#"+item._id,ref=this.references[id];if(!ref){this.length++;var res=create.call(item),name=item._class;name&&res[0]!==name&&res.unshift(name),this.definitions[id]=res,ref=this.references[id]=[id]}return ref}}),obj&&obj._serialize){res=obj._serialize(options,dictionary);var name=obj._class;!name||obj._compactSerialize||!isRoot&&compact||res[0]===name||res.unshift(name)}else if(Array.isArray(obj)){res=[];for(var i=0,l=obj.length;i<l;i++)res[i]=Base.serialize(obj[i],options,compact,dictionary)}else if(Base.isPlainObject(obj)){res={};var keys=Object.keys(obj);for(i=0,l=keys.length;i<l;i++){var key=keys[i];res[key]=Base.serialize(obj[key],options,compact,dictionary)}}else res="number"==typeof obj?options.formatter.number(obj,options.precision):obj;return isRoot&&0<dictionary.length?[["dictionary",dictionary.definitions],res]:res},deserialize:function(json,create,_data,_setDictionary,_isRoot){var res=json,isFirst=!_data,hasDictionary=isFirst&&json&&json.length&&"dictionary"===json[0][0];if(_data=_data||{},Array.isArray(json)){var type=json[0],isDictionary="dictionary"===type;if(1==json.length&&/^#/.test(type))return _data.dictionary[type];res=[];for(var i=(type=Base.exports[type])?1:0,l=json.length;i<l;i++)res.push(Base.deserialize(json[i],create,_data,isDictionary,hasDictionary));if(type){var args=res;res=create?create(type,args,isFirst||_isRoot):new type(args)}}else if(Base.isPlainObject(json))for(var key in res={},_setDictionary&&(_data.dictionary=res),json)res[key]=Base.deserialize(json[key],create,_data);return hasDictionary?res[1]:res},exportJSON:function(obj,options){var json=Base.serialize(obj,options);return options&&0==options.asString?json:JSON.stringify(json)},importJSON:function(json,target){return Base.deserialize("string"==typeof json?JSON.parse(json):json,function(ctor,args,isRoot){var useTarget=isRoot&&target&&target.constructor===ctor,obj=useTarget?target:Base.create(ctor.prototype);if(1===args.length&&obj instanceof Item&&(useTarget||!(obj instanceof Layer))){var arg=args[0];Base.isPlainObject(arg)&&(arg.insert=!1,useTarget&&(args=args.concat([{insert:!0}])))}return(useTarget?obj.set:ctor).apply(obj,args),useTarget&&(target=null),obj})},push:function(list,items){var itemsLength=items.length;if(itemsLength<4096)list.push.apply(list,items);else{var startLength=list.length;list.length+=itemsLength;for(var i=0;i<itemsLength;i++)list[startLength+i]=items[i]}return list},splice:function(list,items,index,remove){var amount=items&&items.length,append=void 0===index;(index=append?list.length:index)>list.length&&(index=list.length);for(var i=0;i<amount;i++)items[i]._index=index+i;if(append)return Base.push(list,items),[];var args=[index,remove];items&&Base.push(args,items);for(var removed=list.splice.apply(list,args),l=(i=0,removed.length);i<l;i++)removed[i]._index=void 0;for(i=index+amount,l=list.length;i<l;i++)list[i]._index=i;return removed},capitalize:function(str){return str.replace(/\b[a-z]/g,function(match){return match.toUpperCase()})},camelize:function(str){return str.replace(/-(.)/g,function(match,chr){return chr.toUpperCase()})},hyphenate:function(str){return str.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var Segment=Base.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(arg0,arg1,arg2,arg3,arg4,arg5){var point,handleIn,handleOut,selection,count=arguments.length;0<count&&(null==arg0||"object"==typeof arg0?selection=1===count&&arg0&&"point"in arg0?(point=arg0.point,handleIn=arg0.handleIn,handleOut=arg0.handleOut,arg0.selection):(point=arg0,handleIn=arg1,handleOut=arg2,arg3):(point=[arg0,arg1],handleIn=void 0!==arg2?[arg2,arg3]:null,handleOut=void 0!==arg4?[arg4,arg5]:null)),new SegmentPoint(point,this,"_point"),new SegmentPoint(handleIn,this,"_handleIn"),new SegmentPoint(handleOut,this,"_handleOut"),selection&&this.setSelection(selection)},_serialize:function(options,dictionary){var point=this._point,selection=this._selection,obj=selection||this.hasHandles()?[point,this._handleIn,this._handleOut]:point;return selection&&obj.push(selection),Base.serialize(obj,options,!0,dictionary)},_changed:function(point){var path=this._path;if(path){var curve,curves=path._curves,index=this._index;curves&&(point&&point!==this._point&&point!==this._handleIn||!(curve=0<index?curves[index-1]:path._closed?curves[curves.length-1]:null)||curve._changed(),point&&point!==this._point&&point!==this._handleOut||!(curve=curves[index])||curve._changed()),path._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(Point.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(Point.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(Point.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var handleIn=this._handleIn,handleOut=this._handleOut;return!handleIn.isZero()&&!handleOut.isZero()&&handleIn.isCollinear(handleOut)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(selection){var oldSelection=this._selection,path=this._path;this._selection=selection=selection||0,path&&selection!==oldSelection&&(path._updateSelection(this,oldSelection,selection),path._changed(257))},_changeSelection:function(flag,selected){var selection=this._selection;this.setSelection(selected?selection|flag:selection&~flag)},isSelected:function(){return!!(7&this._selection)},setSelected:function(selected){this._changeSelection(7,selected)},getIndex:function(){return void 0!==this._index?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var path=this._path,index=this._index;return path?(0<index&&!path._closed&&index===path._segments.length-1&&index--,path.getCurves()[index]||null):null},getLocation:function(){var curve=this.getCurve();return curve?new CurveLocation(curve,this===curve._segment1?0:1):null},getNext:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index+1]||this._path._closed&&segments[0])||null},smooth:function(options,_first,_last){var opts=options||{},type=opts.type,factor=opts.factor,prev=this.getPrevious(),next=this.getNext(),p0=(prev||this)._point,p1=this._point,p2=(next||this)._point,d1=p0.getDistance(p1),d2=p1.getDistance(p2);if(type&&"catmull-rom"!==type){if("geometric"!==type)throw new Error("Smoothing method '"+type+"' not supported.");if(prev&&next){var vector=p0.subtract(p2),t=void 0===factor?.4:factor,k=t*d1/(d1+d2);_first||this.setHandleIn(vector.multiply(k)),_last||this.setHandleOut(vector.multiply(k-t))}}else{var a=void 0===factor?.5:factor,d1_a=Math.pow(d1,a),d1_2a=d1_a*d1_a,d2_a=Math.pow(d2,a),d2_2a=d2_a*d2_a;if(!_first&&prev){var A=2*d2_2a+3*d2_a*d1_a+d1_2a,N=3*d2_a*(d2_a+d1_a);this.setHandleIn(0!==N?new Point((d2_2a*p0._x+A*p1._x-d1_2a*p2._x)/N-p1._x,(d2_2a*p0._y+A*p1._y-d1_2a*p2._y)/N-p1._y):new Point)}if(!_last&&next){A=2*d1_2a+3*d1_a*d2_a+d2_2a,N=3*d1_a*(d1_a+d2_a);this.setHandleOut(0!==N?new Point((d1_2a*p2._x+A*p1._x-d2_2a*p0._x)/N-p1._x,(d1_2a*p2._y+A*p1._y-d2_2a*p0._y)/N-p1._y):new Point)}}},getPrevious:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index-1]||this._path._closed&&segments[segments.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var path=this._path;return path&&this._index===path._segments.length-1||!1},reverse:function(){var handleIn=this._handleIn,handleOut=this._handleOut,tmp=handleIn.clone();handleIn.set(handleOut),handleOut.set(tmp)},reversed:function(){return new Segment(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new Segment(this._point,this._handleIn,this._handleOut)},equals:function(segment){return segment===this||segment&&this._class===segment._class&&this._point.equals(segment._point)&&this._handleIn.equals(segment._handleIn)&&this._handleOut.equals(segment._handleOut)||!1},toString:function(){var parts=["point: "+this._point];return this._handleIn.isZero()||parts.push("handleIn: "+this._handleIn),this._handleOut.isZero()||parts.push("handleOut: "+this._handleOut),"{ "+parts.join(", ")+" }"},transform:function(matrix){this._transformCoordinates(matrix,new Array(6),!0),this._changed()},interpolate:function(from,to,factor){var u=1-factor,v=factor,point1=from._point,point2=to._point,handleIn1=from._handleIn,handleIn2=to._handleIn,handleOut2=to._handleOut,handleOut1=from._handleOut;this._point._set(u*point1._x+v*point2._x,u*point1._y+v*point2._y,!0),this._handleIn._set(u*handleIn1._x+v*handleIn2._x,u*handleIn1._y+v*handleIn2._y,!0),this._handleOut._set(u*handleOut1._x+v*handleOut2._x,u*handleOut1._y+v*handleOut2._y,!0),this._changed()},_transformCoordinates:function(matrix,coords,change){var point=this._point,handleIn=change&&this._handleIn.isZero()?null:this._handleIn,handleOut=change&&this._handleOut.isZero()?null:this._handleOut,x=point._x,y=point._y,i=2;return coords[0]=x,coords[1]=y,handleIn&&(coords[i++]=handleIn._x+x,coords[i++]=handleIn._y+y),handleOut&&(coords[i++]=handleOut._x+x,coords[i++]=handleOut._y+y),matrix&&(matrix._transformCoordinates(coords,coords,i/2),x=coords[0],y=coords[1],change?(point._x=x,point._y=y,i=2,handleIn&&(handleIn._x=coords[i++]-x,handleIn._y=coords[i++]-y),handleOut&&(handleOut._x=coords[i++]-x,handleOut._y=coords[i++]-y)):(handleIn||(coords[i++]=x,coords[i++]=y),handleOut||(coords[i++]=x,coords[i++]=y))),coords}}),Point=Base.extend({_class:"Point",_readIndex:!0,initialize:function(arg0,arg1){var type=typeof arg0,reading=this.__read,read=0;if("number"==type){var hasY="number"==typeof arg1;this._set(arg0,hasY?arg1:arg0),reading&&(read=hasY?2:1)}else if("undefined"==type||null===arg0)this._set(0,0),reading&&(read=null===arg0?1:0);else{var obj="string"==type?arg0.split(/[\s,]+/)||[]:arg0;read=1,Array.isArray(obj)?this._set(+obj[0],+(1<obj.length?obj[1]:obj[0])):"x"in obj?this._set(obj.x||0,obj.y||0):"width"in obj?this._set(obj.width||0,obj.height||0):"angle"in obj?(this._set(obj.length||0,0),this.setAngle(obj.angle||0)):(this._set(0,0),read=0)}return reading&&(this.__read=read),this},set:"#initialize",_set:function(x,y){return this.x=x,this.y=y,this._x=x,this._y=y,this},equals:function(point){return this===point||point&&(this.x===point.x&&this.y===point.y||Array.isArray(point)&&this.x===point[0]&&this.y===point[1])||!1},clone:function(){return new Point(this.x,this.y)},_serialize:function(options){var f=options.formatter;return[f.number(this.x),f.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(length){if(this.isZero()){var angle=this._angle||0;this._set(Math.cos(angle)*length,Math.sin(angle)*length)}else{var scale=length/this.getLength();Numerical.isZero(scale)&&this.getAngle(),this._set(this.x*scale,this.y*scale)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(angle){this.setAngleInRadians.call(this,angle*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var point=Point.read(arguments),div=this.getLength()*point.getLength();if(Numerical.isZero(div))return NaN;var a=this.dot(point)/div;return Math.acos(a<-1?-1:1<a?1:a)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(angle){if(this._angle=angle,!this.isZero()){var length=this.getLength();this._set(Math.cos(angle)*length,Math.sin(angle)*length)}},getQuadrant:function(){return 0<=this.x?0<=this.y?1:4:0<=this.y?2:3},getDistance:function(){var point=Point.read(arguments),x=point.x-this.x,y=point.y-this.y,d=x*x+y*y;return Base.read(arguments)?d:Math.sqrt(d)}},Base.each(["round","ceil","floor","abs"],function(key){var op=Math[key];this[key]=function(){return new Point(op(this.x),op(this.y))}},{})),SegmentPoint=Point.extend({initialize:function(point,owner,key){var x,y,selected;if(point)if(void 0!==(x=point[0]))y=point[1];else{var pt=point;void 0===(x=pt.x)&&(x=(pt=Point.read(arguments)).x),y=pt.y,selected=pt.selected}else x=y=0;this._x=x,this._y=y,(this._owner=owner)[key]=this,selected&&this.setSelected(!0)}}),Numerical=new function(){var abscissas=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],abs=Math.abs,sqrt=Math.sqrt,pow=Math.pow,log2=Math.log2||function(x){return Math.log(x)*Math.LOG2E};function clamp(value,min,max){return value<min?min:max<value?max:value}function getDiscriminant(a,b,c){function split(v){var x=134217729*v,hi=v-x+x;return[hi,v-hi]}var D=b*b-a*c,E=b*b+a*c;if(3*abs(D)<E){var ad=split(a),bd=split(b),cd=split(c),p=b*b,q=a*c;D=p-q+(bd[0]*bd[0]-p+2*bd[0]*bd[1]+bd[1]*bd[1]-(ad[0]*cd[0]-q+ad[0]*cd[1]+ad[1]*cd[0]+ad[1]*cd[1]))}return D}function getNormalizationFactor(){var norm=Math.max.apply(Math,arguments);return norm&&(norm<1e-8||1e8<norm)?pow(2,-Math.round(log2(norm))):0}return{EPSILON:1e-12,MACHINE_EPSILON:112e-18,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,KAPPA:4*(sqrt(2)-1)/3,isZero:function(val){return-1e-12<=val&&val<=1e-12},clamp:clamp,integrate:function(f,a,b,n){for(var x=abscissas[n-2],w=weights[n-2],A=.5*(b-a),B=A+a,i=0,m=n+1>>1,sum=1&n?w[i++]*f(B):0;i<m;){var Ax=A*x[i];sum+=w[i++]*(f(B+Ax)+f(B-Ax))}return A*sum},findRoot:function(f,df,x,a,b,n,tolerance){for(var i=0;i<n;i++){var fx=f(x),dx=fx/df(x),nx=x-dx;if(abs(dx)<tolerance){x=nx;break}x=0<fx?(b=x,nx<=a?.5*(a+b):nx):(a=x,b<=nx?.5*(a+b):nx)}return clamp(x,a,b)},solveQuadratic:function(a,b,c,roots,min,max){var x1,x2=1/0;if(abs(a)<1e-12){if(abs(b)<1e-12)return abs(c)<1e-12?-1:0;x1=-c/b}else{var D=getDiscriminant(a,b*=-.5,c);if(D&&abs(D)<112e-18){var f=getNormalizationFactor(abs(a),abs(b),abs(c));f&&(D=getDiscriminant(a*=f,b*=f,c*=f))}if(-112e-18<=D){var Q=D<0?0:sqrt(D),R=b+(b<0?-Q:Q);x2=0===R?-(x1=c/a):(x1=R/a,c/R)}}var count=0,boundless=null==min,minB=min-1e-12,maxB=max+1e-12;return isFinite(x1)&&(boundless||minB<x1&&x1<maxB)&&(roots[count++]=boundless?x1:clamp(x1,min,max)),x2!==x1&&isFinite(x2)&&(boundless||minB<x2&&x2<maxB)&&(roots[count++]=boundless?x2:clamp(x2,min,max)),count},solveCubic:function(a,b,c,d,roots,min,max){var x,b1,c2,qd,q,f=getNormalizationFactor(abs(a),abs(b),abs(c),abs(d));function evaluate(x0){var tmp=a*(x=x0);qd=(tmp+(b1=tmp+b))*x+(c2=b1*x+c),q=c2*x+d}if(f&&(a*=f,b*=f,c*=f,d*=f),abs(a)<1e-12)a=b,b1=c,c2=d,x=1/0;else if(abs(d)<1e-12)b1=b,c2=c,x=0;else{evaluate(-b/a/3);var t=q/a,r=pow(abs(t),1/3),s=t<0?-1:1,td=-qd/a,rd=0<td?1.324717957244746*Math.max(r,sqrt(td)):r,x0=x-s*rd;if(x0!==x){for(;evaluate(x0),s*x<s*(x0=0===qd?x:x-q/qd/(1+112e-18)););abs(a)*x*x>abs(d/x)&&(b1=((c2=-d/x)-c)/x)}}var count=Numerical.solveQuadratic(a,b1,c2,roots,min,max),boundless=null==min;return isFinite(x)&&(0===count||0<count&&x!==roots[0]&&x!==roots[1])&&(boundless||min-1e-12<x&&x<max+1e-12)&&(roots[count++]=boundless?x:clamp(x,min,max)),count}}};function simplifyPath(points){if(null!=points&&0<points.length){for(var pts=[],prev=null,l=points.length,i=0;i<l;i++){var pt=points[i]._point;prev&&prev._x==pt._x&&prev._y==pt._y||(pts.push(new Point(pt._x,pt._y)),prev=pt)}l=pts.length;var retPts=[new Segment(pts[0])];return 1<l&&fitCubic(retPts,pts,10,0,l-1,subtract(pts[1],pts[0]),subtract(pts[l-2],pts[l-1])),retPts}return null}function drawSegments(ctx,path,matrix){var curX,curY,prevX,prevY,inX,inY,outX,outY,segments=path,length=path.length,coords=new Array(6),first=!0;function drawSegment(segment){if(matrix)segment._transformCoordinates(matrix,coords),curX=coords[0],curY=coords[1];else{var point=segment._point;curX=point._x,curY=point._y}if(first)ctx.moveTo(curX,curY),first=!1;else{if(matrix)inX=coords[2],inY=coords[3];else{var handle=segment._handleIn;inX=curX+handle._x,inY=curY+handle._y}inX===curX&&inY===curY&&outX===prevX&&outY===prevY?ctx.lineTo(curX,curY):ctx.bezierCurveTo(outX,outY,inX,inY,curX,curY)}if(prevX=curX,prevY=curY,matrix)outX=coords[4],outY=coords[5];else{handle=segment._handleOut;outX=prevX+handle._x,outY=prevY+handle._y}}for(var i=0;i<length;i++)drawSegment(segments[i]);path._closed&&0<length&&drawSegment(segments[0])}function getDistance(pt1,pt2){pt1=Point.read(arguments);var x=(pt2=Point.read(arguments,1)).x-pt1.x,y=pt2.y-pt1.y,d=x*x+y*y;return Math.sqrt(d)}function subtract(){var pt1=Point.read(arguments),pt2=Point.read(arguments,1);return new Point(pt1.x-pt2.x,pt1.y-pt2.y)}function normalize(pt,length){if(void 0===length&&(length=1),null!=pt&&void 0!==pt){var current=Math.sqrt(pt.x*pt.x+pt.y*pt.y),scale=0!==current?length/current:0,point=new Point(pt.x*scale,pt.y*scale);return 0<=scale&&(point._angle=pt._angle),point}}function multiply(){var pt1=Point.read(arguments),pt2=Point.read(arguments,1);return new Point(pt1.x*pt2.x,pt1.y*pt2.y)}function negate(){var pt=Point.read(arguments);return new Point(-pt.x,-pt.y)}function dot(){var pt1=Point.read(arguments),pt2=Point.read(arguments,1);return pt1.x*pt2.x+pt1.y*pt2.y}function add(){var pt1=Point.read(arguments),pt2=Point.read(arguments,1);return new Point(pt1.x+pt2.x,pt1.y+pt2.y)}function generateBezier(pts,first,last,uPrime,tan1,tan2){for(var abs=Math.abs,points=pts,pt1=points[first],pt2=points[last],C=[[0,0],[0,0]],X=[0,0],i=0,l=last-first+1;i<l;i++){var u=uPrime[i],t=1-u,b=3*u*t,b0=t*t*t,b1=b*t,b2=b*u,b3=u*u*u,a1=normalize(tan1,b1),a2=normalize(tan2,b2),tmp=subtract(subtract(points[first+i],multiply(pt1,b0+b1)),multiply(pt2,b2+b3));C[0][0]+=dot(a1,a1),C[0][1]+=dot(a1,a2),C[1][0]=C[0][1],C[1][1]+=dot(a2,a2),X[0]+=dot(a1,tmp),X[1]+=dot(a2,tmp)}var alpha1,alpha2,detC0C1=C[0][0]*C[1][1]-C[1][0]*C[0][1];if(1e-12<abs(detC0C1)){var detC0X=C[0][0]*X[1]-C[1][0]*X[0];alpha1=(X[0]*C[1][1]-X[1]*C[0][1])/detC0C1,alpha2=detC0X/detC0C1}else{var c0=C[0][0]+C[0][1],c1=C[1][0]+C[1][1];alpha1=alpha2=1e-12<abs(c0)?X[0]/c0:1e-12<abs(c1)?X[1]/c1:0}var handle1,handle2,segLength=getDistance(pt2,pt1),eps=1e-12*segLength;if(alpha1<eps||alpha2<eps)alpha1=alpha2=segLength/3;else{var line=subtract(pt2,pt1);handle1=normalize(tan1,alpha1),handle2=normalize(tan2,alpha2),dot(handle1,line)-dot(handle2,line)>segLength*segLength&&(alpha1=alpha2=segLength/3,handle1=handle2=null)}return[pt1,add(pt1,handle1||normalize(tan1,alpha1)),add(pt2,handle2||normalize(tan2,alpha2)),pt2]}function fitCubic(retPts,pts,error,first,last,tan1,tan2){if(last-first!=1){for(var split,uPrime=chordLengthParameterize(pts,first,last),maxError=Math.max(error,error*error),parametersInOrder=!0,i=0;i<=4;i++){var curve=generateBezier(pts,first,last,uPrime,tan1,tan2),max=findMaxError(pts,first,last,curve,uPrime);if(max.error<error&&parametersInOrder)return void addCurve(retPts,curve);if(split=max.index,max.error>=maxError)break;parametersInOrder=reparameterize(pts,first,last,uPrime,curve),maxError=max.error}var tanCenter=subtract(pts[split-1],pts[split+1]);fitCubic(retPts,pts,error,first,split,tan1,tanCenter),fitCubic(retPts,pts,error,split,last,negate(tanCenter),tan2)}else{var pt1=pts[first],pt2=pts[last],dist=getDistance(pt1,pt2)/3;addCurve(retPts,[pt1,add(pt1,normalize(tan1,dist)),add(pt2,normalize(tan2,dist)),pt2])}}function addCurve(retPts,curve){retPts[retPts.length-1].setHandleOut(subtract(curve[1],curve[0])),retPts.push(new Segment(curve[3],subtract(curve[2],curve[3])))}function chordLengthParameterize(pts,first,last){for(var u=[0],i=first+1;i<=last;i++)u[i-first]=u[i-first-1]+pts[i].getDistance(pts[i-1]);i=1;for(var m=last-first;i<=m;i++)u[i]/=u[m];return u}function evaluate(degree,curve,t){for(var tmp=curve.slice(),i=1;i<=degree;i++)for(var j=0;j<=degree-i;j++)tmp[j]=add(multiply(tmp[j],1-t),multiply(tmp[j+1],t));return tmp[0]}function findMaxError(pts,first,last,curve,u){for(var index=Math.floor((last-first+1)/2),maxDist=0,i=first+1;i<last;i++){var v=subtract(evaluate(3,curve,u[i-first]),pts[i]),dist=v.x*v.x+v.y*v.y;maxDist<=dist&&(maxDist=dist,index=i)}return{error:maxDist,index:index}}function findRoot(curve,point,u){for(var curve1=[],curve2=[],i=0;i<=2;i++)curve1[i]=multiply(subtract(curve[i+1],curve[i]),3);for(i=0;i<=1;i++)curve2[i]=multiply(subtract(curve1[i+1],curve1[i]),2);var pt=evaluate(3,curve,u),pt1=evaluate(2,curve1,u),pt2=evaluate(1,curve2,u),diff=subtract(pt,point),df=dot(pt1,pt1)+dot(diff,pt2);return Numerical.isZero(df)?u:u-dot(diff,pt1)/df}function reparameterize(pts,first,last,u,curve){for(var i=first;i<=last;i++)u[i-first]=findRoot(curve,pts[i],u[i-first]);i=1;for(var l=u.length;i<l;i++)if(u[i]<=u[i-1])return!1;return!0}